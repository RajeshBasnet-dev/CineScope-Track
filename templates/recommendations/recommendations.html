{% extends 'base.html' %}

{% block title %}Recommendations - CineScope Tracker{% endblock %}

{% block content %}
<div class="max-w-screen-xl mx-auto">
    <div class="flex justify-between items-center mb-8">
        <h1 class="text-3xl font-bold text-white-text"><i class="fas fa-lightbulb mr-2"></i>What to Watch Next</h1>
        <button id="refresh-recommendations" class="px-4 py-2 bg-dark-accent hover:bg-dark-card text-white-text rounded-lg font-medium transition duration-300 border border-dark-accent flex items-center">
            <i class="fas fa-sync-alt mr-2"></i> Refresh
        </button>
    </div>
    
    <p class="text-light-text mb-8">Personalized picks based on your viewing history</p>
    
    <!-- Because You Loved (Content-Based) -->
    <div class="bg-dark-card rounded-2xl p-6 mb-8 shadow-lg">
        <div class="flex justify-between items-center mb-6">
            <h2 class="text-xl font-semibold text-white-text"><i class="fas fa-heart mr-2"></i>Because You Loved</h2>
        </div>
        <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-6">
            {% for rec in content_based %}
            <div class="group relative bg-dark-accent rounded-xl overflow-hidden shadow-lg hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-1">
                <div class="aspect-w-2 aspect-h-3">
                    {% if rec.poster_path %}
                    <img src="https://image.tmdb.org/t/p/w500{{ rec.poster_path }}" alt="{{ rec.title }}" class="w-full h-80 object-cover">
                    {% else %}
                    <div class="bg-dark-card border-2 border-dashed rounded-xl w-full h-80 flex items-center justify-center">
                        <i class="fas fa-film text-gray-500 text-4xl"></i>
                    </div>
                    {% endif %}
                </div>
                <div class="absolute inset-0 bg-gradient-to-t from-dark-card to-transparent opacity-90"></div>
                <div class="absolute bottom-0 left-0 right-0 p-4">
                    <h3 class="font-semibold text-white-text text-sm truncate">{{ rec.title }}</h3>
                    <div class="flex items-center mt-1">
                        <i class="fas fa-star text-yellow-400 text-xs mr-1"></i>
                        <span class="text-xs text-light-text">{{ rec.rating|floatformat:1 }}</span>
                    </div>
                    <div class="text-xs text-electric-blue mt-1">{{ rec.similarity_score|floatformat:0 }}% Match</div>
                </div>
                <div class="absolute inset-0 bg-electric-blue/20 opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-center justify-center">
                    <button class="add-to-watchlist bg-electric-blue hover:bg-vibrant-teal text-white-text px-3 py-1 rounded-lg font-medium text-xs transition duration-300 flex items-center" 
                            data-content-id="{{ rec.content_id }}" data-content-type="{{ rec.content_type }}">
                        <i class="fas fa-plus mr-1"></i> Add
                    </button>
                </div>
            </div>
            {% empty %}
            <div class="col-span-full text-center py-8">
                <p class="text-light-text">Rate more content to get personalized recommendations</p>
            </div>
            {% endfor %}
        </div>
    </div>
    
    <!-- Trending in Sci-Fi -->
    <div class="bg-dark-card rounded-2xl p-6 mb-8 shadow-lg">
        <div class="flex justify-between items-center mb-6">
            <h2 class="text-xl font-semibold text-white-text"><i class="fas fa-fire mr-2"></i>Trending in Sci-Fi (Your Favorite Genre)</h2>
        </div>
        <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-6">
            <!-- Trending Item 1 -->
            <div class="group relative bg-dark-accent rounded-xl overflow-hidden shadow-lg hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-1">
                <div class="aspect-w-2 aspect-h-3">
                    <div class="bg-dark-card border-2 border-dashed rounded-xl w-full h-80 flex items-center justify-center">
                        <i class="fas fa-film text-gray-500 text-4xl"></i>
                    </div>
                </div>
                <div class="absolute inset-0 bg-gradient-to-t from-dark-card to-transparent opacity-90"></div>
                <div class="absolute bottom-0 left-0 right-0 p-4">
                    <h3 class="font-semibold text-white-text text-sm truncate">Dune</h3>
                    <div class="flex items-center mt-1">
                        <i class="fas fa-star text-yellow-400 text-xs mr-1"></i>
                        <span class="text-xs text-light-text">8.0</span>
                    </div>
                </div>
                <div class="absolute inset-0 bg-electric-blue/20 opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-center justify-center">
                    <button class="add-to-watchlist bg-electric-blue hover:bg-vibrant-teal text-white-text px-3 py-1 rounded-lg font-medium text-xs transition duration-300 flex items-center" 
                            data-content-id="438631" data-content-type="movie">
                        <i class="fas fa-plus mr-1"></i> Add
                    </button>
                </div>
            </div>
            
            <!-- Trending Item 2 -->
            <div class="group relative bg-dark-accent rounded-xl overflow-hidden shadow-lg hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-1">
                <div class="aspect-w-2 aspect-h-3">
                    <div class="bg-dark-card border-2 border-dashed rounded-xl w-full h-80 flex items-center justify-center">
                        <i class="fas fa-film text-gray-500 text-4xl"></i>
                    </div>
                </div>
                <div class="absolute inset-0 bg-gradient-to-t from-dark-card to-transparent opacity-90"></div>
                <div class="absolute bottom-0 left-0 right-0 p-4">
                    <h3 class="font-semibold text-white-text text-sm truncate">Blade Runner 2049</h3>
                    <div class="flex items-center mt-1">
                        <i class="fas fa-star text-yellow-400 text-xs mr-1"></i>
                        <span class="text-xs text-light-text">8.0</span>
                    </div>
                </div>
                <div class="absolute inset-0 bg-electric-blue/20 opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-center justify-center">
                    <button class="add-to-watchlist bg-electric-blue hover:bg-vibrant-teal text-white-text px-3 py-1 rounded-lg font-medium text-xs transition duration-300 flex items-center" 
                            data-content-id="335984" data-content-type="movie">
                        <i class="fas fa-plus mr-1"></i> Add
                    </button>
                </div>
            </div>
            
            <!-- Trending Item 3 -->
            <div class="group relative bg-dark-accent rounded-xl overflow-hidden shadow-lg hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-1">
                <div class="aspect-w-2 aspect-h-3">
                    <div class="bg-dark-card border-2 border-dashed rounded-xl w-full h-80 flex items-center justify-center">
                        <i class="fas fa-film text-gray-500 text-4xl"></i>
                    </div>
                </div>
                <div class="absolute inset-0 bg-gradient-to-t from-dark-card to-transparent opacity-90"></div>
                <div class="absolute bottom-0 left-0 right-0 p-4">
                    <h3 class="font-semibold text-white-text text-sm truncate">Arrival</h3>
                    <div class="flex items-center mt-1">
                        <i class="fas fa-star text-yellow-400 text-xs mr-1"></i>
                        <span class="text-xs text-light-text">7.9</span>
                    </div>
                </div>
                <div class="absolute inset-0 bg-electric-blue/20 opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-center justify-center">
                    <button class="add-to-watchlist bg-electric-blue hover:bg-vibrant-teal text-white-text px-3 py-1 rounded-lg font-medium text-xs transition duration-300 flex items-center" 
                            data-content-id="329865" data-content-type="movie">
                        <i class="fas fa-plus mr-1"></i> Add
                    </button>
                </div>
            </div>
            
            <!-- Trending Item 4 -->
            <div class="group relative bg-dark-accent rounded-xl overflow-hidden shadow-lg hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-1">
                <div class="aspect-w-2 aspect-h-3">
                    <div class="bg-dark-card border-2 border-dashed rounded-xl w-full h-80 flex items-center justify-center">
                        <i class="fas fa-film text-gray-500 text-4xl"></i>
                    </div>
                </div>
                <div class="absolute inset-0 bg-gradient-to-t from-dark-card to-transparent opacity-90"></div>
                <div class="absolute bottom-0 left-0 right-0 p-4">
                    <h3 class="font-semibold text-white-text text-sm truncate">Ex Machina</h3>
                    <div class="flex items-center mt-1">
                        <i class="fas fa-star text-yellow-400 text-xs mr-1"></i>
                        <span class="text-xs text-light-text">7.7</span>
                    </div>
                </div>
                <div class="absolute inset-0 bg-electric-blue/20 opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-center justify-center">
                    <button class="add-to-watchlist bg-electric-blue hover:bg-vibrant-teal text-white-text px-3 py-1 rounded-lg font-medium text-xs transition duration-300 flex items-center" 
                            data-content-id="264660" data-content-type="movie">
                        <i class="fas fa-plus mr-1"></i> Add
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- New Releases -->
    <div class="bg-dark-card rounded-2xl p-6 mb-8 shadow-lg">
        <div class="flex justify-between items-center mb-6">
            <h2 class="text-xl font-semibold text-white-text"><i class="fas fa-plus-circle mr-2"></i>New Releases You Might Like</h2>
        </div>
        <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-6">
            <!-- New Release 1 -->
            <div class="group relative bg-dark-accent rounded-xl overflow-hidden shadow-lg hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-1">
                <div class="aspect-w-2 aspect-h-3">
                    <div class="bg-dark-card border-2 border-dashed rounded-xl w-full h-80 flex items-center justify-center">
                        <i class="fas fa-film text-gray-500 text-4xl"></i>
                    </div>
                </div>
                <div class="absolute inset-0 bg-gradient-to-t from-dark-card to-transparent opacity-90"></div>
                <div class="absolute bottom-0 left-0 right-0 p-4">
                    <h3 class="font-semibold text-white-text text-sm truncate">Top Gun: Maverick</h3>
                    <div class="flex items-center mt-1">
                        <i class="fas fa-star text-yellow-400 text-xs mr-1"></i>
                        <span class="text-xs text-light-text">8.3</span>
                    </div>
                </div>
                <div class="absolute inset-0 bg-electric-blue/20 opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-center justify-center">
                    <button class="add-to-watchlist bg-electric-blue hover:bg-vibrant-teal text-white-text px-3 py-1 rounded-lg font-medium text-xs transition duration-300 flex items-center" 
                            data-content-id="361743" data-content-type="movie">
                        <i class="fas fa-plus mr-1"></i> Add
                    </button>
                </div>
            </div>
            
            <!-- New Release 2 -->
            <div class="group relative bg-dark-accent rounded-xl overflow-hidden shadow-lg hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-1">
                <div class="aspect-w-2 aspect-h-3">
                    <div class="bg-dark-card border-2 border-dashed rounded-xl w-full h-80 flex items-center justify-center">
                        <i class="fas fa-film text-gray-500 text-4xl"></i>
                    </div>
                </div>
                <div class="absolute inset-0 bg-gradient-to-t from-dark-card to-transparent opacity-90"></div>
                <div class="absolute bottom-0 left-0 right-0 p-4">
                    <h3 class="font-semibold text-white-text text-sm truncate">Spider-Man: No Way Home</h3>
                    <div class="flex items-center mt-1">
                        <i class="fas fa-star text-yellow-400 text-xs mr-1"></i>
                        <span class="text-xs text-light-text">8.2</span>
                    </div>
                </div>
                <div class="absolute inset-0 bg-electric-blue/20 opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-center justify-center">
                    <button class="add-to-watchlist bg-electric-blue hover:bg-vibrant-teal text-white-text px-3 py-1 rounded-lg font-medium text-xs transition duration-300 flex items-center" 
                            data-content-id="634649" data-content-type="movie">
                        <i class="fas fa-plus mr-1"></i> Add
                    </button>
                </div>
            </div>
            
            <!-- New Release 3 -->
            <div class="group relative bg-dark-accent rounded-xl overflow-hidden shadow-lg hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-1">
                <div class="aspect-w-2 aspect-h-3">
                    <div class="bg-dark-card border-2 border-dashed rounded-xl w-full h-80 flex items-center justify-center">
                        <i class="fas fa-film text-gray-500 text-4xl"></i>
                    </div>
                </div>
                <div class="absolute inset-0 bg-gradient-to-t from-dark-card to-transparent opacity-90"></div>
                <div class="absolute bottom-0 left-0 right-0 p-4">
                    <h3 class="font-semibold text-white-text text-sm truncate">The Batman</h3>
                    <div class="flex items-center mt-1">
                        <i class="fas fa-star text-yellow-400 text-xs mr-1"></i>
                        <span class="text-xs text-light-text">7.8</span>
                    </div>
                </div>
                <div class="absolute inset-0 bg-electric-blue/20 opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-center justify-center">
                    <button class="add-to-watchlist bg-electric-blue hover:bg-vibrant-teal text-white-text px-3 py-1 rounded-lg font-medium text-xs transition duration-300 flex items-center" 
                            data-content-id="414906" data-content-type="movie">
                        <i class="fas fa-plus mr-1"></i> Add
                    </button>
                </div>
            </div>
            
            <!-- New Release 4 -->
            <div class="group relative bg-dark-accent rounded-xl overflow-hidden shadow-lg hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-1">
                <div class="aspect-w-2 aspect-h-3">
                    <div class="bg-dark-card border-2 border-dashed rounded-xl w-full h-80 flex items-center justify-center">
                        <i class="fas fa-film text-gray-500 text-4xl"></i>
                    </div>
                </div>
                <div class="absolute inset-0 bg-gradient-to-t from-dark-card to-transparent opacity-90"></div>
                <div class="absolute bottom-0 left-0 right-0 p-4">
                    <h3 class="font-semibold text-white-text text-sm truncate">Doctor Strange in the Multiverse of Madness</h3>
                    <div class="flex items-center mt-1">
                        <i class="fas fa-star text-yellow-400 text-xs mr-1"></i>
                        <span class="text-xs text-light-text">6.9</span>
                    </div>
                </div>
                <div class="absolute inset-0 bg-electric-blue/20 opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-center justify-center">
                    <button class="add-to-watchlist bg-electric-blue hover:bg-vibrant-teal text-white-text px-3 py-1 rounded-lg font-medium text-xs transition duration-300 flex items-center" 
                            data-content-id="453395" data-content-type="movie">
                        <i class="fas fa-plus mr-1"></i> Add
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Hidden Gems -->
    <div class="bg-dark-card rounded-2xl p-6 mb-8 shadow-lg">
        <div class="flex justify-between items-center mb-6">
            <h2 class="text-xl font-semibold text-white-text"><i class="fas fa-gem mr-2"></i>Hidden Gems</h2>
            <p class="text-light-text text-sm">Highly rated but less watched</p>
        </div>
        <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-6">
            <!-- Hidden Gem 1 -->
            <div class="group relative bg-dark-accent rounded-xl overflow-hidden shadow-lg hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-1">
                <div class="aspect-w-2 aspect-h-3">
                    <div class="bg-dark-card border-2 border-dashed rounded-xl w-full h-80 flex items-center justify-center">
                        <i class="fas fa-film text-gray-500 text-4xl"></i>
                    </div>
                </div>
                <div class="absolute inset-0 bg-gradient-to-t from-dark-card to-transparent opacity-90"></div>
                <div class="absolute bottom-0 left-0 right-0 p-4">
                    <h3 class="font-semibold text-white-text text-sm truncate">The Fall</h3>
                    <div class="flex items-center mt-1">
                        <i class="fas fa-star text-yellow-400 text-xs mr-1"></i>
                        <span class="text-xs text-light-text">9.1</span>
                    </div>
                    <div class="text-xs text-light-text mt-1">12K views</div>
                </div>
                <div class="absolute inset-0 bg-electric-blue/20 opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-center justify-center">
                    <button class="add-to-watchlist bg-electric-blue hover:bg-vibrant-teal text-white-text px-3 py-1 rounded-lg font-medium text-xs transition duration-300 flex items-center" 
                            data-content-id="396" data-content-type="movie">
                        <i class="fas fa-plus mr-1"></i> Add
                    </button>
                </div>
            </div>
            
            <!-- Hidden Gem 2 -->
            <div class="group relative bg-dark-accent rounded-xl overflow-hidden shadow-lg hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-1">
                <div class="aspect-w-2 aspect-h-3">
                    <div class="bg-dark-card border-2 border-dashed rounded-xl w-full h-80 flex items-center justify-center">
                        <i class="fas fa-film text-gray-500 text-4xl"></i>
                    </div>
                </div>
                <div class="absolute inset-0 bg-gradient-to-t from-dark-card to-transparent opacity-90"></div>
                <div class="absolute bottom-0 left-0 right-0 p-4">
                    <h3 class="font-semibold text-white-text text-sm truncate">A Ghost Story</h3>
                    <div class="flex items-center mt-1">
                        <i class="fas fa-star text-yellow-400 text-xs mr-1"></i>
                        <span class="text-xs text-light-text">8.9</span>
                    </div>
                    <div class="text-xs text-light-text mt-1">8K views</div>
                </div>
                <div class="absolute inset-0 bg-electric-blue/20 opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-center justify-center">
                    <button class="add-to-watchlist bg-electric-blue hover:bg-vibrant-teal text-white-text px-3 py-1 rounded-lg font-medium text-xs transition duration-300 flex items-center" 
                            data-content-id="396747" data-content-type="movie">
                        <i class="fas fa-plus mr-1"></i> Add
                    </button>
                </div>
            </div>
            
            <!-- Hidden Gem 3 -->
            <div class="group relative bg-dark-accent rounded-xl overflow-hidden shadow-lg hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-1">
                <div class="aspect-w-2 aspect-h-3">
                    <div class="bg-dark-card border-2 border-dashed rounded-xl w-full h-80 flex items-center justify-center">
                        <i class="fas fa-film text-gray-500 text-4xl"></i>
                    </div>
                </div>
                <div class="absolute inset-0 bg-gradient-to-t from-dark-card to-transparent opacity-90"></div>
                <div class="absolute bottom-0 left-0 right-0 p-4">
                    <h3 class="font-semibold text-white-text text-sm truncate">Coherence</h3>
                    <div class="flex items-center mt-1">
                        <i class="fas fa-star text-yellow-400 text-xs mr-1"></i>
                        <span class="text-xs text-light-text">8.8</span>
                    </div>
                    <div class="text-xs text-light-text mt-1">15K views</div>
                </div>
                <div class="absolute inset-0 bg-electric-blue/20 opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-center justify-center">
                    <button class="add-to-watchlist bg-electric-blue hover:bg-vibrant-teal text-white-text px-3 py-1 rounded-lg font-medium text-xs transition duration-300 flex items-center" 
                            data-content-id="248054" data-content-type="movie">
                        <i class="fas fa-plus mr-1"></i> Add
                    </button>
                </div>
            </div>
            
            <!-- Hidden Gem 4 -->
            <div class="group relative bg-dark-accent rounded-xl overflow-hidden shadow-lg hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-1">
                <div class="aspect-w-2 aspect-h-3">
                    <div class="bg-dark-card border-2 border-dashed rounded-xl w-full h-80 flex items-center justify-center">
                        <i class="fas fa-film text-gray-500 text-4xl"></i>
                    </div>
                </div>
                <div class="absolute inset-0 bg-gradient-to-t from-dark-card to-transparent opacity-90"></div>
                <div class="absolute bottom-0 left-0 right-0 p-4">
                    <h3 class="font-semibold text-white-text text-sm truncate">The Invitation</h3>
                    <div class="flex items-center mt-1">
                        <i class="fas fa-star text-yellow-400 text-xs mr-1"></i>
                        <span class="text-xs text-light-text">8.7</span>
                    </div>
                    <div class="text-xs text-light-text mt-1">9K views</div>
                </div>
                <div class="absolute inset-0 bg-electric-blue/20 opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-center justify-center">
                    <button class="add-to-watchlist bg-electric-blue hover:bg-vibrant-teal text-white-text px-3 py-1 rounded-lg font-medium text-xs transition duration-300 flex items-center" 
                            data-content-id="27527" data-content-type="movie">
                        <i class="fas fa-plus mr-1"></i> Add
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Complete Your Collection -->
    <div class="bg-dark-card rounded-2xl p-6 shadow-lg">
        <div class="flex justify-between items-center mb-6">
            <h2 class="text-xl font-semibold text-white-text"><i class="fas fa-film mr-2"></i>Complete Your Collection</h2>
            <p class="text-light-text text-sm">Sequels, prequels, and related content</p>
        </div>
        <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-6">
            <!-- Collection Item 1 -->
            <div class="group relative bg-dark-accent rounded-xl overflow-hidden shadow-lg hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-1">
                <div class="aspect-w-2 aspect-h-3">
                    <div class="bg-dark-card border-2 border-dashed rounded-xl w-full h-80 flex items-center justify-center">
                        <i class="fas fa-film text-gray-500 text-4xl"></i>
                    </div>
                </div>
                <div class="absolute inset-0 bg-gradient-to-t from-dark-card to-transparent opacity-90"></div>
                <div class="absolute bottom-0 left-0 right-0 p-4">
                    <h3 class="font-semibold text-white-text text-sm truncate">The Matrix Reloaded</h3>
                    <div class="flex items-center mt-1">
                        <i class="fas fa-star text-yellow-400 text-xs mr-1"></i>
                        <span class="text-xs text-light-text">7.2</span>
                    </div>
                    <div class="text-xs text-light-text mt-1">Sequel</div>
                </div>
                <div class="absolute inset-0 bg-electric-blue/20 opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-center justify-center">
                    <button class="add-to-watchlist bg-electric-blue hover:bg-vibrant-teal text-white-text px-3 py-1 rounded-lg font-medium text-xs transition duration-300 flex items-center" 
                            data-content-id="604" data-content-type="movie">
                        <i class="fas fa-plus mr-1"></i> Add
                    </button>
                </div>
            </div>
            
            <!-- Collection Item 2 -->
            <div class="group relative bg-dark-accent rounded-xl overflow-hidden shadow-lg hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-1">
                <div class="aspect-w-2 aspect-h-3">
                    <div class="bg-dark-card border-2 border-dashed rounded-xl w-full h-80 flex items-center justify-center">
                        <i class="fas fa-film text-gray-500 text-4xl"></i>
                    </div>
                </div>
                <div class="absolute inset-0 bg-gradient-to-t from-dark-card to-transparent opacity-90"></div>
                <div class="absolute bottom-0 left-0 right-0 p-4">
                    <h3 class="font-semibold text-white-text text-sm truncate">The Matrix Revolutions</h3>
                    <div class="flex items-center mt-1">
                        <i class="fas fa-star text-yellow-400 text-xs mr-1"></i>
                        <span class="text-xs text-light-text">6.8</span>
                    </div>
                    <div class="text-xs text-light-text mt-1">Sequel</div>
                </div>
                <div class="absolute inset-0 bg-electric-blue/20 opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-center justify-center">
                    <button class="add-to-watchlist bg-electric-blue hover:bg-vibrant-teal text-white-text px-3 py-1 rounded-lg font-medium text-xs transition duration-300 flex items-center" 
                            data-content-id="605" data-content-type="movie">
                        <i class="fas fa-plus mr-1"></i> Add
                    </button>
                </div>
            </div>
            
            <!-- Collection Item 3 -->
            <div class="group relative bg-dark-accent rounded-xl overflow-hidden shadow-lg hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-1">
                <div class="aspect-w-2 aspect-h-3">
                    <div class="bg-dark-card border-2 border-dashed rounded-xl w-full h-80 flex items-center justify-center">
                        <i class="fas fa-film text-gray-500 text-4xl"></i>
                    </div>
                </div>
                <div class="absolute inset-0 bg-gradient-to-t from-dark-card to-transparent opacity-90"></div>
                <div class="absolute bottom-0 left-0 right-0 p-4">
                    <h3 class="font-semibold text-white-text text-sm truncate">The Matrix Resurrections</h3>
                    <div class="flex items-center mt-1">
                        <i class="fas fa-star text-yellow-400 text-xs mr-1"></i>
                        <span class="text-xs text-light-text">5.7</span>
                    </div>
                    <div class="text-xs text-light-text mt-1">Sequel</div>
                </div>
                <div class="absolute inset-0 bg-electric-blue/20 opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-center justify-center">
                    <button class="add-to-watchlist bg-electric-blue hover:bg-vibrant-teal text-white-text px-3 py-1 rounded-lg font-medium text-xs transition duration-300 flex items-center" 
                            data-content-id="624860" data-content-type="movie">
                        <i class="fas fa-plus mr-1"></i> Add
                    </button>
                </div>
            </div>
            
            <!-- Collection Item 4 -->
            <div class="group relative bg-dark-accent rounded-xl overflow-hidden shadow-lg hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-1">
                <div class="aspect-w-2 aspect-h-3">
                    <div class="bg-dark-card border-2 border-dashed rounded-xl w-full h-80 flex items-center justify-center">
                        <i class="fas fa-film text-gray-500 text-4xl"></i>
                    </div>
                </div>
                <div class="absolute inset-0 bg-gradient-to-t from-dark-card to-transparent opacity-90"></div>
                <div class="absolute bottom-0 left-0 right-0 p-4">
                    <h3 class="font-semibold text-white-text text-sm truncate">John Wick</h3>
                    <div class="flex items-center mt-1">
                        <i class="fas fa-star text-yellow-400 text-xs mr-1"></i>
                        <span class="text-xs text-light-text">7.4</span>
                    </div>
                    <div class="text-xs text-light-text mt-1">Related</div>
                </div>
                <div class="absolute inset-0 bg-electric-blue/20 opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-center justify-center">
                    <button class="add-to-watchlist bg-electric-blue hover:bg-vibrant-teal text-white-text px-3 py-1 rounded-lg font-medium text-xs transition duration-300 flex items-center" 
                            data-content-id="245891" data-content-type="movie">
                        <i class="fas fa-plus mr-1"></i> Add
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
document.getElementById('refresh-recommendations').addEventListener('click', function() {
    this.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i> Refreshing...';
    this.disabled = true;
    
    // Call the generate recommendations endpoint
    fetch('{% url "generate_recommendations" %}', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'X-CSRFToken': document.querySelector('[name=csrfmiddlewaretoken]').value
        }
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            // Show success notification
            const notification = document.createElement('div');
            notification.className = 'fixed top-4 right-4 bg-green-600 text-white-text px-4 py-2 rounded-lg shadow-lg z-50';
            notification.textContent = 'Recommendations refreshed!';
            document.body.appendChild(notification);
            
            // Auto remove after 2 seconds
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.remove();
                }
                // Reload the page to show new recommendations
                location.reload();
            }, 2000);
        } else {
            // Show error notification
            const notification = document.createElement('div');
            notification.className = 'fixed top-4 right-4 bg-red-600 text-white-text px-4 py-2 rounded-lg shadow-lg z-50';
            notification.textContent = 'Failed to refresh recommendations';
            document.body.appendChild(notification);
            
            // Reset button
            this.innerHTML = '<i class="fas fa-sync-alt mr-2"></i> Refresh';
            this.disabled = false;
            
            // Auto remove after 2 seconds
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.remove();
                }
            }, 2000);
        }
    })
    .catch(error => {
        console.error('Error:', error);
        // Show error notification
        const notification = document.createElement('div');
        notification.className = 'fixed top-4 right-4 bg-red-600 text-white-text px-4 py-2 rounded-lg shadow-lg z-50';
        notification.textContent = 'Network error';
        document.body.appendChild(notification);
        
        // Reset button
        this.innerHTML = '<i class="fas fa-sync-alt mr-2"></i> Refresh';
        this.disabled = false;
        
        // Auto remove after 2 seconds
        setTimeout(() => {
            if (notification.parentNode) {
                notification.remove();
            }
        }, 2000);
    });
});

// Add to watchlist functionality for recommendation items
document.addEventListener('DOMContentLoaded', function() {
    // Add event listeners to all "Add" buttons
    const addButtons = document.querySelectorAll('.add-to-watchlist');
    
    addButtons.forEach(button => {
        button.addEventListener('click', function() {
            // Check if user is authenticated
            if (!document.querySelector('[name=csrfmiddlewaretoken]')) {
                alert('Please sign in to add items to your watchlist');
                return;
            }
            
            // Get content ID and type from data attributes
            const contentId = this.dataset.contentId;
            const contentType = this.dataset.contentType;
            
            // Store original button content for reset
            const originalHTML = this.innerHTML;
            
            // Show loading state
            this.innerHTML = '<i class="fas fa-spinner fa-spin mr-1"></i> Adding...';
            this.disabled = true;
            
            // Send request to add to watchlist
            fetch('{% url "add_to_watchlist" %}', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-CSRFToken': document.querySelector('[name=csrfmiddlewaretoken]').value
                },
                body: JSON.stringify({
                    content_id: contentId,
                    content_type: contentType,
                    status: 'plan_to_watch'
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    // Change button text and style to indicate success
                    this.innerHTML = '<i class="fas fa-check mr-1"></i> Added';
                    this.classList.remove('bg-electric-blue', 'hover:bg-vibrant-teal');
                    this.classList.add('bg-green-600');
                    
                    // Reset button after 2 seconds
                    setTimeout(() => {
                        this.innerHTML = originalHTML;
                        this.classList.remove('bg-green-600');
                        this.classList.add('bg-electric-blue', 'hover:bg-vibrant-teal');
                        this.disabled = false;
                    }, 2000);
                } else {
                    alert('Failed to add to watchlist: ' + data.message);
                    this.innerHTML = originalHTML;
                    this.disabled = false;
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('Network error while adding to watchlist');
                this.innerHTML = originalHTML;
                this.disabled = false;
            });
        });
    });
});
</script>
{% endblock %}